<!-- HRM-Next Inspired Header Component -->
<header class="header-container">
  <!-- Left Section -->
  <div class="header-left">
    <button 
      class="sidebar-toggle" 
      (click)="handleToggleSidebar()"
      [attr.aria-label]="'Toggle sidebar'">
      <i class="pi pi-bars"></i>
    </button>
    
    <div class="header-title">
      <h1 class="title">{{ title() }}</h1>
      @if (subtitle()) {
        <p class="subtitle">{{ subtitle() }}</p>
      }
    </div>
  </div>

  <!-- Center Section - Search -->
  @if (showSearch()) {
    <div class="header-center">
      <div class="search-container">
        <i class="pi pi-search search-icon"></i>
        <input 
          type="text" 
          class="search-input"
          placeholder="Search..."
          [(ngModel)]="searchQuery"
          (keyup.enter)="handleSearch()"
          (input)="handleSearch()">
      </div>
    </div>
  }

  <!-- Right Section -->
  <div class="header-right">
    <!-- Notifications -->
    @if (showNotifications()) {
      <div class="notification-container">
        <button 
          class="notification-toggle"
          (click)="toggleNotificationMenu()"
          [class.active]="isNotificationMenuOpen"
          [attr.aria-label]="'Notifications'">
          <i class="pi pi-bell"></i>
          @if (getUnreadNotificationCount() > 0) {
            <span class="notification-badge">{{ getUnreadNotificationCount() }}</span>
          }
        </button>

        <!-- Notification Dropdown -->
        @if (isNotificationMenuOpen) {
          <div class="notification-dropdown">
            <div class="notification-header">
              <h3>Notifications</h3>
              <button class="mark-all-read">Mark all read</button>
            </div>
            <div class="notification-list">
              @if (notifications().length === 0) {
                <div class="no-notifications">
                  <i class="pi pi-bell-slash"></i>
                  <p>No notifications</p>
                </div>
              } @else {
                @for (notification of notifications(); track notification.id) {
                  <div 
                    class="notification-item"
                    [class.unread]="!notification.read"
                    (click)="handleNotificationClick(notification)"
                    (keydown.enter)="handleNotificationClick(notification)"
                    (keydown.space)="handleNotificationClick(notification)"
                    tabindex="0"
                    role="button"
                    [attr.aria-label]="'View ' + notification.title + ' notification'">
                    <div class="notification-icon" [class]="'type-' + notification.type">
                      <i class="pi" [class]="{
                        'pi-info-circle': notification.type === 'info',
                        'pi-check-circle': notification.type === 'success',
                        'pi-exclamation-triangle': notification.type === 'warning',
                        'pi-times-circle': notification.type === 'error'
                      }"></i>
                    </div>
                    <div class="notification-content">
                      <h4 class="notification-title">{{ notification.title }}</h4>
                      <p class="notification-message">{{ notification.message }}</p>
                      <span class="notification-time">{{ formatTimestamp(notification.timestamp) }}</span>
                    </div>
                  </div>
                }
              }
            </div>
          </div>
        }
      </div>
    }

    <!-- User Menu -->
    @if (showUserMenu() && userProfile()) {
      <div class="user-menu-container">
        <button 
          class="user-menu-toggle"
          (click)="toggleUserMenu()"
          [class.active]="isUserMenuOpen">
          <img 
            [src]="userProfile()?.avatar || 'https://via.placeholder.com/32'" 
            [alt]="userProfile()?.name"
            class="user-avatar">
          <div class="user-info">
            <span class="user-name">{{ userProfile()?.name }}</span>
            <span class="user-role">{{ userProfile()?.role }}</span>
          </div>
          <i class="pi pi-chevron-down user-menu-icon"></i>
        </button>

        <!-- User Dropdown -->
        @if (isUserMenuOpen) {
          <div class="user-dropdown">
            <div class="user-dropdown-header">
              <img 
                [src]="userProfile()?.avatar || 'https://via.placeholder.com/40'" 
                [alt]="userProfile()?.name"
                class="user-dropdown-avatar">
              <div class="user-dropdown-info">
                <h4 class="user-dropdown-name">{{ userProfile()?.name }}</h4>
                <p class="user-dropdown-email">{{ userProfile()?.email }}</p>
              </div>
            </div>
            <div class="user-dropdown-menu">
              <a routerLink="/profile" class="dropdown-item">
                <i class="pi pi-user"></i>
                <span>Profile</span>
              </a>
              <a routerLink="/settings" class="dropdown-item">
                <i class="pi pi-cog"></i>
                <span>Settings</span>
              </a>
              <a routerLink="/help" class="dropdown-item">
                <i class="pi pi-question-circle"></i>
                <span>Help</span>
              </a>
              <div class="dropdown-divider"></div>
              <button class="dropdown-item logout-item" (click)="handleLogout()">
                <i class="pi pi-sign-out"></i>
                <span>Logout</span>
              </button>
            </div>
          </div>
        }
      </div>
    }
  </div>
</header>